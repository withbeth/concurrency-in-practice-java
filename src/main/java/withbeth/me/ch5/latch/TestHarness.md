# Goal

CountDownLatch를 이용한 Latch이용 예제 작성

### Latch

[ What ]
- 스스로가 TERMINATE상태에 이르기전까지 스레드 통과를 막는 동기화 클래스.
- 한번 종료상태에 이르면 상태를 되돌릴수 없다.

[ When to use? ]
- 특정 동작 완료전까지는 어떠한 기능의 동작도 막고 싶은 경우.
- 예를 들어,
  - 특정 자원 확보전까지, 어떠한 기능의 동작의 실행을 막고 싶은 경우
  - 의존성 서비스 실행 전까지, 특정 서비스의 실행을 막고 싶은 경우
  - 작업에 필요한 모든 객체가 실행준비되기 전까지, 작업을 시작하고 싶지 않은 경우.
    - 예: 카트라이더에서 모든 유저가 READY를 해야만 게임 시작이 가능한 것처럼.

### CountDownLatch

- `상태정보` : 이벤트 카운터 N을 갖는다. N은 양수이며, 작업 실행을 위해서 발생해야 하는 이벤트 수를 나타낸다.
- `countDown()` : 이벤트 발생시 N--
- `await()` : 이벤트 카운터가 0이 될때까지 대기

Q. 그렇다면 언제까지 대기하나요?
- Timeout 또는 인터럽트가 발생하거나, 이벤트 카운터가 0이 될때까지 대기.

### TestHarness

[ What ]

- N개의 작업스레드가 `동시` 시작하여, `모두` 종료할때까지의 작업시간을 확인하고 싶다.
- 이를 위해 2개의 Latch 사용.
- Start Latch : 이벤트 카운트 1로 초기화
- End Latch : 이벤트 카운트 N으로 초기화
- 각 작업 스레드는, 
  - 시작시, Start Latch 관문이 열리기를 대기.
  - 종료시, End Latch 관문의 이벤트를 countdown.
- 따라서 모든 작업 스레드가 종료하여 End Latch관문의 이벤트 카운트가 0이 되었을때 종료시간을 확인한다.


